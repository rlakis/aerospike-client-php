<?php

const CN_LEBANON                    = 1;
const CN_EMIRATES                   = 2;
const CN_BAHRAIN                    = 3;
const CN_SAUDI_ARABIA               = 4;
const CN_EGYPT                      = 5;
const SN_SYRIA                      = 6;
const CN_KUWAIT                     = 7;
const CN_JORDAN                     = 8;
const CN_QATAR                      = 9;
const CN_SUDAN                      = 10;
const CN_TUNISIA                    = 11;
const CN_YEMEN                      = 12;
const CN_ALGERIA                    = 15;
const CN_IRAQ                       = 106;
const CN_LIBYA                      = 122;
const CN_MOROCCO                    = 145;
const CN_OMAN                       = 161;

const CT_LB_BEIRUT                  = 1;
const CT_AE_ABU_DHABI               = 4;
const CT_AE_DUBAI                   = 14;
const CT_AE_AIN                     = 6;
const CT_AE_SHARJAH                 = 333;
const CT_AE_AJMAN                   = 436;
const CT_AE_FUJAIRAH                = 812;
const CT_AE_RAS_AL_KHAIMAH          = 815;
const CT_AE_UMM_AL_QUWAIN           = 2609;
const CT_BH_MANAMA                  = 5;
const CT_SA_RIYADH                  = 7;
const CT_SA_JEDDAH                  = 8;
const CT_SA_DAMMAM                  = 9;
const CT_SA_ASEER                   = 12;
const CT_SA_MEDINA                  = 26;
const CT_SA_TABUK                   = 27;
const CT_SA_QASSIM                  = 28;
const CT_SA_AHSA                    = 29;
const CT_SA_HAIL                    = 1255;
const CT_EG_CAIRO                   = 10;
const CT_EG_ALEXANDRIA              = 11;
const CT_EG_UPPER                   = 22;
const CT_EG_DELTA                   = 23;
const CT_SY_DAMASCUS                = 13;
const CT_SY_ALEPPO                  = 21;
const CT_KW_KUWAIT                  = 15;
const CT_KW_TENTH_REGION            = 24;
const CT_KW_JAHRA                   = 25;
const CT_JO_AMMAN                   = 16;
const CT_JO_AQABA                   = 17;
const CT_JO_IRBID                   = 18;
const CT_JO_ZARQAA                  = 19;
const CT_QA_DOHA                    = 20;
const CT_IQ_BASRA                   = 180;
const CT_IQ_BAGHDAD                 = 1239;
const CT_OM_MUSCAT                  = 761;
const CT_MA_CASABLANCA              = 1026;
const CT_SD_KHARTOUM                = 1200;
const CT_YE_SANAA                   = 1224;
const CT_TN_TUNIS                   = 1210;
const CT_DZ_ALGIERS                 = 1226;
const CT_LY_TRIPOLI                 = 1230;

const R_PROPERTIES                  = 1;
const R_AUTOMOTIVES                 = 2;
const R_JOBS                        = 3;
const R_CLASSIFIEDS                 = 99;
const R_SERVICES                    = 4;

const P_FOR_SALE                    = 1;
const P_RENTAL                      = 2;
const P_VACANCIES                   = 3;
const P_SEEKING_WORK                = 4;
const P_ASK_RENT                    = 6;
const P_VARIOUS                     = 999;
const P_OFFERED_SERVICES            = 5;
const P_ASK_BUY                     = 7;
const P_TRADE_IN                    = 8;

const SR_APARTMENTS                  = 1;
const SR_BUILDINGS                   = 8;
const SR_CAMPS                       = 1000;
const SR_CHALETS                     = 4;
const SR_COMMERCIAL_BUILDING         = 346;
const SR_FACTORIES                   = 367;
const SR_FARMS                       = 9;
const SR_FURNISHED_APARTMENTS        = 2;
const SR_HALLS                       = 1458;
const SR_HOTELS_RESORTS              = 419;
const SR_HOUSES                      = 121;
const SR_INTERNATIONAL_REALESTATE    = 748;
const SR_LABOR_ACCOMMODATION         = 162;
const SR_LANDS                       = 7;
const SR_MISCELLANEOUS               = 105;
const SR_OFFICES                     = 6;
const SR_RESTAURANTS_COFFEE_SHOPS    = 498;
const SR_SHARING                     = 106;
const SR_SHOPS                       = 5;
const SR_STUDIOS                     = 122;
const SR_TRADITIONAL_HOUSE           = 294;
const SR_UNDER_CONSTRUCTION          = 1341;
const SR_VILLAS                      = 131;
const SR_VILLAS_AND_HOUSES           = 3;
const SR_WAREHOUSES                  = 111;

const SC_ALFA_ROMEO                  = 76;
const SC_ASIA                        = 100;
const SC_ASTON_MARTIN                = 387;
const SC_AUDI                        = 11;
const SC_AUSTIN                      = 97;
const SC_BENTLEY                     = 98;
const SC_BMW                         = 10;
const SC_BUGATTI                     = 118;
const SC_BUICK                       = 93;
const SC_CADILLAC                    = 21;
const SC_CHERY                       = 120;
const SC_CHEVROLET                   = 22;
const SC_CHRYSLER                    = 55;
const SC_CITROEN                     = 56;
const SC_CLASSIC_CARS                = 75;
const SC_DACIA                       = 104;
const SC_DAEWOO                      = 23;
const SC_DAIHATSU                    = 71;
const SC_DATSUN                      = 1515;
const SC_DFSK                        = 1520;
const SC_DODGE                       = 59;
const SC_FERRARI                     = 94;
const SC_FIAT                        = 24;
const SC_FORD                        = 26;
const SC_GMC                         = 34;
const SC_HONDA                       = 28;
const SC_HUMMER                      = 32;
const SC_HYUNDAY                     = 35;
const SC_IMPORT_CARS                 = 1518;
const SC_INFINITY                    = 73;
const SC_ISUZU                       = 87;
const SC_JAC                         = 1517;
const SC_JAGUAR                      = 37;
const SC_JEEP                        = 38;
const SC_KIA                         = 58;
const SC_LADA                        = 89;
const SC_LAMBORGHINI                 = 101;
const SC_LANCIA                      = 99;
const SC_LAND_ROVER                  = 39;
const SC_LEXUS                       = 30;
const SC_LINCOLN                     = 57;
const SC_LOTUS                       = 386;
const SC_MASERATTI                   = 102;
const SC_MAZDA                       = 40;
const SC_MCLAREN                     = 384;
const SC_MERCEDES                    = 15;
const SC_MERCURY                     = 60;
const SC_MG                          = 103;
const SC_MINI_COOPER                 = 79;
const SC_MITSUBISHI                  = 33;
const SC_MORGAN                      = 119;
const SC_NISSAN                      = 27;
const SC_OLDS_MOBILE                 = 44;
const SC_OPEL                        = 48;
const SC_OTHER_AUTOS                 = 117;
const SC_PEUGEOT                     = 49;
const SC_PLYMOUTH                    = 385;
const SC_PONTIAC                     = 67;
const SC_PORSCHE                     = 74;
const SC_PROTON                      = 90;
const SC_RENAULT                     = 50;
const SC_ROLLS_ROYCE                 = 95;
const SC_ROVER                       = 96;
const SC_SAAB                        = 77;
const SC_SABA                        = 1519;
const SC_SAMSUNG                     = 82;
const SC_SANGYOUNG                   = 78;
const SC_SEAT                        = 51;
const SC_SIMCA                       = 88;
const SC_SKODA                       = 92;
const SC_SMART                       = 80;
const SC_SUBARU                      = 81;
const SC_SUZUKI                      = 52;
const SC_TATA                        = 91;
const SC_TOYOTA                      = 13;
const SC_VOLKS_WAGEN                 = 54;
const SC_VOLVO                       = 53;

const SJ_AC_TECHNICIANS              = 339;
const SJ_ACCOUNTING                  = 14;
const SJ_ADMINISTRATION              = 213;
const SJ_AUDIO_VISUAL                = 334;
const SJ_BEAUTY_CARE                 = 43;
const SJ_CHILD_CARE                  = 329;
const SJ_CLEANING_WORKERS            = 328;
const SJ_CONSTRUCTION                = 389;
const SJ_CRAFTSMEN                   = 1058;
const SJ_CUSTOMER_SERVICE            = 134;
const SJ_DATA_ENTRY                  = 744;
const SJ_DELIVERY                    = 332;
const SJ_DESIGNER                    = 18;
const SJ_DIFFER_JOBS                 = 29;
const SJ_DRIVERS                     = 45;
const SJ_EDITORIAL                   = 170;
const SJ_EMPLOYEE                    = 463;
const SJ_ENGINEERING                 = 36;
const SJ_FASHION                     = 152;
const SJ_FINE_ARTS                   = 42;
const SJ_FITNESS                     = 146;
const SJ_GUARDS                      = 326;
const SJ_HOUSEMAIDS                  = 327;
const SJ_HUMAN_RESOURCES             = 112;
const SJ_INFORMATION_TECHNOLOGY      = 129;
const SJ_LABORS                      = 46;
const SJ_LANDSCAPING                 = 150;
const SJ_LAW                         = 110;
const SJ_MEDICINE_AND_NURSING        = 109;
const SJ_PARTNERSHIP                 = 115;
const SJ_PROGRAMMING                 = 41;
const SJ_PUBLIC_RELATIONS            = 278;
const SJ_SALES_AND_MARKETING         = 16;
const SJ_SECRETERIAL                 = 12;
const SJ_TAILORS                     = 345;
const SJ_TEACHING                    = 20;
const SJ_TECHNICIANS                 = 47;
const SJ_TICKETING                   = 292;
const SJ_TOURIST_AND_RESTAURANTS     = 17;
const SJ_TRANSLATORS                 = 137;
const SJ_WEB_DESIGNERS               = 126;

const SS_HEALTH_BEAUTY               = 192;
const SS_AGRICULTURAL_SERVICES       = 721;
const SS_BUILDING_HOME_SERVICES      = 189;
const SS_BUSINESS_INVESTMENT         = 215;
const SS_CAR_RENTAL                  = 431;
const SS_CAR_SERVICE                 = 586;
const SS_CLEANING_SERVICES           = 1179;
const SS_COMPUTER_SERVICES           = 197;
const SS_CONTRACTING                 = 324;
const SS_DREAM_INTERPRETATION        = 730;
const SS_ENTERTAINMENT               = 191;
const SS_EVENTS_PLANNING             = 438;
const SS_FORMALITIES_SERVICES        = 253;
const SS_GENERAL_SERVICES            = 1487;
const SS_HOMEMADE_COOKING            = 1030;
const SS_HUMAN_RESOURCES_SERVICES    = 185;
const SS_HUMANITARIAN_AID            = 934;
const SS_INTERNET                    = 1437;
const SS_LABOR_RECRUITMENT           = 1201;
const SS_LAW_SERVICES                = 391;
const SS_LOAN_SERVICES               = 1514;
const SS_LOST_FOUND                  = 754;
const SS_MAINTENANCE_SERVICES        = 1114;
const SS_MARKETING_SERVICE           = 283;
const SS_MARRIAGE                    = 1521;
const SS_PEST_CONTROL                = 540;
const SS_PRIVATE_LESSONS             = 19;
const SS_PROFESSIONAL_SERVICES       = 229;
const SS_PROPERTIES_SERVICES         = 321;
const SS_PROPERTY_SERVICES           = 194;
const SS_REMOVAL_SERVICES            = 190;
const SS_SECURITY_SERVICES           = 371;
const SS_SHIPPING_SERVICES           = 193;
const SS_TAX_MONEY_SERVICES          = 195;
const SS_TAXI                        = 260;
const SS_TELECOM_SERVICES            = 196;
const SS_TRANSLATION                 = 224;
const SS_TRAVEL_SERVICES             = 198;
const SS_TUITION_SERVICES            = 199;

const SI_ACCESSORIES                 = 1079;
const SI_AGRICULTURE_EQUIPMENT       = 864;
const SI_ANIMALS_AND_PETS            = 116;
const SI_ANTIQUES_COLLECTIBLES       = 214;
const SI_BILLBOARDS                  = 155;
const SI_BOOKS_MAGAZINES             = 1112;
const SI_BUILDING_MATERIALS          = 363;
const SI_BUS                         = 65;
const SI_CAMERAS                     = 293;
const SI_CAR_NUMBERS                 = 291;
const SI_CLOTHES                     = 85;
const SI_COMPUTERS                   = 144;
const SI_COSMETICS                   = 539;
const SI_ELECTRICITY_GENERATOR       = 296;
const SI_ELECTRONICS                 = 617;
const SI_EQUIPMENTS                  = 297;
const SI_EVENTS                      = 834;
const SI_FISHING                     = 1314;
const SI_FOOD_NUTRITION              = 515;
const SI_FRAGRANCES                  = 513;
const SI_FURNITURE                   = 84;
const SI_GAMES                       = 279;
const SI_HAJJ_AND_OMRA               = 130;
const SI_HEALTH_CARE                 = 132;
const SI_HEAVY_DUTY_VEHICLE          = 69;
const SI_HOME_APPLIANCES             = 125;
const SI_HUNTING                     = 350;
const SI_INDUSTRIAL_EQUIPMENT        = 223;
const SI_ITEMS                       = 114;
const SI_LICENSES                    = 124;
const SI_MEDICAL_EQUIPMENT           = 392;
const SI_MOTORCYLES                  = 107;
const SI_MOTORHOME                   = 1061;
const SI_MUSICAL_INSTRUMENTS         = 135;
const SI_NAUTICAL_EQUIPMENT          = 108;
const SI_NUMBERS                     = 113;
const SI_PICK_UPS                    = 62;
const SI_PUBLIC_PLATE                = 325;
const SI_SECURITY_SYSTEMS            = 534;
const SI_SMARTPHONE                  = 123;
const SI_SOFTWARE_SOLUTIONS          = 766;
const SI_SPARE_PARTS                 = 236;
const SI_SPORTS_EQUIPMENT            = 343;
const SI_UNCLASSIFIED                = 63;
const SI_WATCHES                     = 298;
const SI_WHOLESALE_DEALS             = 924;

const RK                            = 'roots';
const SK                            = 'sections';

const INTL                          = 'i';

const PRPS                          = 'p';
const CN                            = 'cn';
const CT                            = 'cc';

const SOURCE                        = 'src';
const DESTINATION                   = 'dst';
const MOVED                         = 'mv';
const LEVEL                         = 'pl';
const BLOCKED                       = 'blk';

// allow, then deny

class MCPostPreferences implements \JsonSerializable {
    private $version = [ 'major'=>1, 'minor'=>5 ];

    private $properties;
    private $cars;
    private $jobs;
    private $services;
    private $items;
    private $countries;
    
    public function jsonSerialize() {
        return get_object_vars($this);
    }

    
    public function getVersion() : int {
        return ($this->version['major'] << 32) | ($this->version['minor'] & 0xFFFFFFF);
      
    }
    
    
    public function setup() {  
        $this->countries = [CN_LEBANON, CN_EMIRATES, CN_BAHRAIN, CN_SAUDI_ARABIA, CN_EGYPT, SN_SYRIA, CN_KUWAIT, 
            CN_JORDAN, CN_QATAR, CN_SUDAN, CN_TUNISIA, CN_YEMEN, CN_ALGERIA, CN_IRAQ, CN_LIBYA, CN_MOROCCO, CN_OMAN];
        
        $this->properties = MCPreference::newInstance(R_PROPERTIES)->publishLevel(MCPublishLevel::City, [P_FOR_SALE, P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN]);
        
        $this->properties->allow()->purposes([P_FOR_SALE, P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN])->setSource(MCRegionType::Local);
        
        $this->properties->allow()->countries([CN_LEBANON])->setSource(MCRegionType::International);
        $this->properties->deny()->purposes([P_OFFERED_SERVICES, P_SEEKING_WORK, P_VACANCIES, P_VARIOUS]);
        
        $this->properties->section(SR_APARTMENTS);
        $this->properties->section(SR_BUILDINGS);
        $this->properties->section(SR_CAMPS)->deny()->countries([CN_LEBANON]);
        $this->properties->section(SR_CHALETS);
        $this->properties->section(SR_COMMERCIAL_BUILDING);
        $this->properties->section(SR_FACTORIES);
        $this->properties->section(SR_FARMS);
        $this->properties->section(SR_FURNISHED_APARTMENTS);
        $this->properties->section(SR_HALLS);
        $this->properties->section(SR_HOTELS_RESORTS);
        $this->properties->section(SR_HOUSES)->deny()->movedTo(SR_VILLAS_AND_HOUSES);
        
        $this->properties->section(SR_INTERNATIONAL_REALESTATE)->deny()->purposes([P_ASK_RENT, P_ASK_BUY, P_TRADE_IN]);
        $this->properties->section(SR_INTERNATIONAL_REALESTATE)->allow()->setSource(MCRegionType::International);
        $this->properties->section(SR_INTERNATIONAL_REALESTATE)->publishLevel(MCPublishLevel::Internationl, [P_FOR_SALE, P_RENTAL]);
                
        $this->properties->section(SR_LABOR_ACCOMMODATION)->deny()->countries([CN_LEBANON]);
        $this->properties->section(SR_LANDS);
        $this->properties->section(SR_MISCELLANEOUS);
        $this->properties->section(SR_OFFICES);
        $this->properties->section(SR_RESTAURANTS_COFFEE_SHOPS);
        $this->properties->section(SR_SHARING)->deny()->purposes([P_FOR_SALE, P_ASK_BUY, P_TRADE_IN]);        
        $this->properties->section(SR_SHOPS);
        //$this->properties->section(SR_TRADITIONAL_HOUSE);
        $this->properties->section(SR_TRADITIONAL_HOUSE)->deny()->countries([CN_LEBANON, CN_BAHRAIN]);//->movedTo(SR_VILLAS_AND_HOUSES);
        
        $this->properties->section(SR_UNDER_CONSTRUCTION)->deny()->purposes([P_RENTAL, P_ASK_RENT, P_TRADE_IN]);        
        $this->properties->section(SR_VILLAS)->deny()->movedTo(SR_VILLAS_AND_HOUSES);        
        $this->properties->section(SR_VILLAS_AND_HOUSES);
        $this->properties->section(SR_WAREHOUSES);        
        
        $this->properties->appendToTail(SR_INTERNATIONAL_REALESTATE)->appendToTail(SR_MISCELLANEOUS);        
        
        
        $this->cars = MCPreference::newInstance(R_AUTOMOTIVES)->publishLevel(MCPublishLevel::City, [P_FOR_SALE, P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN]);
        $this->cars->allow()->purposes([P_FOR_SALE, P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN])->setSource(MCRegionType::Local);
        $this->cars->deny()->purposes([P_OFFERED_SERVICES, P_SEEKING_WORK, P_VACANCIES, P_VARIOUS]);

        $this->cars->section(SC_ALFA_ROMEO);
        $this->cars->section(SC_ASIA);
        $this->cars->section(SC_ASTON_MARTIN);
        $this->cars->section(SC_AUDI);
        $this->cars->section(SC_AUSTIN);
        $this->cars->section(SC_BENTLEY);
        $this->cars->section(SC_BMW);
        $this->cars->section(SC_BUGATTI);
        $this->cars->section(SC_BUICK);
        $this->cars->section(SC_CADILLAC);
        $this->cars->section(SC_CHERY);
        $this->cars->section(SC_CHEVROLET);
        $this->cars->section(SC_CHRYSLER);
        $this->cars->section(SC_CITROEN);
        $this->cars->section(SC_CLASSIC_CARS);
        $this->cars->section(SC_DACIA);
        $this->cars->section(SC_DAEWOO);
        $this->cars->section(SC_DAIHATSU);
        $this->cars->section(SC_DATSUN);
        $this->cars->section(SC_DFSK);
        $this->cars->section(SC_DODGE);
        $this->cars->section(SC_FERRARI);
        $this->cars->section(SC_FIAT);
        $this->cars->section(SC_FORD);
        $this->cars->section(SC_GMC);
        $this->cars->section(SC_HONDA);
        $this->cars->section(SC_HUMMER);
        $this->cars->section(SC_HYUNDAY);
        $this->cars->section(SC_IMPORT_CARS)->publishLevel(MCPublishLevel::Internationl, [P_FOR_SALE]);
        $this->cars->section(SC_IMPORT_CARS)->allow()->setSource(MCRegionType::International);
        $this->cars->section(SC_IMPORT_CARS)->deny()->purposes([P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN]);
        $this->cars->section(SC_INFINITY);
        $this->cars->section(SC_ISUZU);
        $this->cars->section(SC_JAC);
        $this->cars->section(SC_JAGUAR);
        $this->cars->section(SC_JEEP);
        $this->cars->section(SC_KIA);
        $this->cars->section(SC_LADA);
        $this->cars->section(SC_LAMBORGHINI);
        $this->cars->section(SC_LANCIA);
        $this->cars->section(SC_LAND_ROVER);
        $this->cars->section(SC_LEXUS);
        $this->cars->section(SC_LINCOLN);
        $this->cars->section(SC_LOTUS);
        $this->cars->section(SC_MASERATTI);
        $this->cars->section(SC_MAZDA);
        $this->cars->section(SC_MCLAREN);
        $this->cars->section(SC_MERCEDES);
        $this->cars->section(SC_MERCURY);
        $this->cars->section(SC_MG);
        $this->cars->section(SC_MINI_COOPER);
        $this->cars->section(SC_MITSUBISHI);
        $this->cars->section(SC_MORGAN);
        $this->cars->section(SC_NISSAN);
        $this->cars->section(SC_OLDS_MOBILE);
        $this->cars->section(SC_OPEL);
        $this->cars->section(SC_OTHER_AUTOS);
        $this->cars->section(SC_PEUGEOT);
        $this->cars->section(SC_PLYMOUTH);
        $this->cars->section(SC_PONTIAC);
        $this->cars->section(SC_PORSCHE);
        $this->cars->section(SC_PROTON);
        $this->cars->section(SC_RENAULT);
        $this->cars->section(SC_ROLLS_ROYCE);
        $this->cars->section(SC_ROVER);
        $this->cars->section(SC_SAAB);
        $this->cars->section(SC_SABA);
        $this->cars->section(SC_SAMSUNG);
        $this->cars->section(SC_SANGYOUNG);
        $this->cars->section(SC_SEAT);
        $this->cars->section(SC_SIMCA);
        $this->cars->section(SC_SKODA);
        $this->cars->section(SC_SMART);
        $this->cars->section(SC_SUBARU);
        $this->cars->section(SC_SUZUKI);
        $this->cars->section(SC_TATA);
        $this->cars->section(SC_TOYOTA);
        $this->cars->section(SC_VOLKS_WAGEN);
        $this->cars->section(SC_VOLVO);
        
        $this->cars->appendToTail(SC_CLASSIC_CARS)->appendToTail(SC_IMPORT_CARS)->appendToTail(SC_OTHER_AUTOS);
        
        
        $this->jobs = MCPreference::newInstance(R_JOBS)->publishLevel(MCPublishLevel::Country, [P_OFFERED_SERVICES, P_VACANCIES])->publishLevel(MCPublishLevel::Internationl, [P_SEEKING_WORK]);        
        $this->jobs->deny()->purposes([P_FOR_SALE, P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN, P_VARIOUS]);
        $this->jobs->allow()->purposes([P_OFFERED_SERVICES, P_VACANCIES])->setSource(MCRegionType::Local);
        $this->jobs->allow()->purposes([P_SEEKING_WORK])->setSource(MCRegionType::International);

        $this->jobs->section(SJ_TECHNICIANS)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_GENERAL_SERVICES);        
        $this->jobs->section(SJ_ACCOUNTING)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_TAX_MONEY_SERVICES);        
        $this->jobs->section(SJ_ADMINISTRATION)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_PROFESSIONAL_SERVICES);        
        $this->jobs->section(SJ_AUDIO_VISUAL);        
        $this->jobs->section(SJ_BEAUTY_CARE);        
        $this->jobs->section(SJ_CHILD_CARE);        
        $this->jobs->section(SJ_CLEANING_WORKERS)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_CLEANING_SERVICES);
        $this->jobs->section(SJ_CONSTRUCTION)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_CONTRACTING);
        $this->jobs->section(SJ_CRAFTSMEN);        
        $this->jobs->section(SJ_CUSTOMER_SERVICE);        
        $this->jobs->section(SJ_DATA_ENTRY);
        $this->jobs->section(SJ_DELIVERY)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_TAX_MONEY_SERVICES);    
        $this->jobs->section(SJ_DESIGNER);
        $this->jobs->section(SJ_DIFFER_JOBS);
        $this->jobs->section(SJ_DRIVERS)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_TAXI);
        $this->jobs->section(SJ_EDITORIAL);
        $this->jobs->section(SJ_EMPLOYEE);
        $this->jobs->section(SJ_ENGINEERING);
        $this->jobs->section(SJ_FASHION);
        $this->jobs->section(SJ_FINE_ARTS);
        $this->jobs->section(SJ_FITNESS);
        $this->jobs->section(SJ_GUARDS);
        $this->jobs->section(SJ_HOUSEMAIDS);
        $this->jobs->section(SJ_HUMAN_RESOURCES);
        $this->jobs->section(SJ_INFORMATION_TECHNOLOGY);
        $this->jobs->section(SJ_LABORS);
        $this->jobs->section(SJ_LANDSCAPING);
        $this->jobs->section(SJ_LAW);
        $this->jobs->section(SJ_MEDICINE_AND_NURSING);
        $this->jobs->section(SJ_PARTNERSHIP);
        $this->jobs->section(SJ_PROGRAMMING);
        $this->jobs->section(SJ_PUBLIC_RELATIONS);
        $this->jobs->section(SJ_SALES_AND_MARKETING);
        $this->jobs->section(SJ_SECRETERIAL);
        $this->jobs->section(SJ_TAILORS);
        $this->jobs->section(SJ_TEACHING)->deny()->purpose(P_OFFERED_SERVICES)->movedTo(SS_TUITION_SERVICES);
        $this->jobs->section(SJ_TECHNICIANS);
        $this->jobs->section(SJ_TICKETING);
        $this->jobs->section(SJ_TOURIST_AND_RESTAURANTS);
        $this->jobs->section(SJ_TRANSLATORS);
        $this->jobs->section(SJ_WEB_DESIGNERS);
        
        $this->jobs->appendToTail(SJ_DIFFER_JOBS);
        
                
        $this->services = MCPreference::newInstance(R_SERVICES)->publishLevel(MCPublishLevel::Country, [P_OFFERED_SERVICES]);
        $this->services->allow()->purposes([P_OFFERED_SERVICES])->setSource(MCRegionType::Local);
        $this->services->deny()->purposes([ P_FOR_SALE, P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN, P_SEEKING_WORK, P_VACANCIES, P_VARIOUS]);
        
        $this->services->section(SS_HEALTH_BEAUTY);
        $this->services->section(SS_AGRICULTURAL_SERVICES);
        $this->services->section(SS_BUILDING_HOME_SERVICES);
        $this->services->section(SS_BUSINESS_INVESTMENT);
        $this->services->section(SS_CAR_RENTAL);
        $this->services->section(SS_CAR_SERVICE);
        $this->services->section(SS_CLEANING_SERVICES);
        $this->services->section(SS_COMPUTER_SERVICES);
        $this->services->section(SS_CONTRACTING);
        $this->services->section(SS_DREAM_INTERPRETATION);
        $this->services->section(SS_ENTERTAINMENT);
        $this->services->section(SS_EVENTS_PLANNING);
        $this->services->section(SS_FORMALITIES_SERVICES);
        $this->services->section(SS_GENERAL_SERVICES);
        $this->services->section(SS_HOMEMADE_COOKING);
        $this->services->section(SS_HUMAN_RESOURCES_SERVICES);
        $this->services->section(SS_HUMANITARIAN_AID);
        $this->services->section(SS_INTERNET);
        $this->services->section(SS_LABOR_RECRUITMENT);
        $this->services->section(SS_LAW_SERVICES);
        $this->services->section(SS_LOAN_SERVICES);
        $this->services->section(SS_LOST_FOUND);
        $this->services->section(SS_MAINTENANCE_SERVICES);
        $this->services->section(SS_MARKETING_SERVICE);
        $this->services->section(SS_MARRIAGE);
        $this->services->section(SS_PEST_CONTROL);
        $this->services->section(SS_PRIVATE_LESSONS);
        $this->services->section(SS_PROFESSIONAL_SERVICES);
        $this->services->section(SS_PROPERTIES_SERVICES);
        $this->services->section(SS_PROPERTY_SERVICES);
        $this->services->section(SS_REMOVAL_SERVICES);
        $this->services->section(SS_SECURITY_SERVICES);
        $this->services->section(SS_SHIPPING_SERVICES);
        $this->services->section(SS_TAX_MONEY_SERVICES);
        $this->services->section(SS_TAXI);
        $this->services->section(SS_TELECOM_SERVICES);
        $this->services->section(SS_TRANSLATION);
        $this->services->section(SS_TRAVEL_SERVICES)->publishLevel(MCPublishLevel::Internationl, [P_OFFERED_SERVICES]);
        $this->services->section(SS_TUITION_SERVICES);
        
        
        $this->items = MCPreference::newInstance(R_CLASSIFIEDS)->publishLevel(MCPublishLevel::City, [P_FOR_SALE, P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN]);
                
        $this->items->section(SI_ACCESSORIES);
        $this->items->section(SI_AGRICULTURE_EQUIPMENT);
        $this->items->section(SI_ANIMALS_AND_PETS)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_ANTIQUES_COLLECTIBLES)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_BILLBOARDS)->deny()->purposes([P_ASK_RENT, P_ASK_BUY, P_TRADE_IN]);
        $this->items->section(SI_BOOKS_MAGAZINES)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_BUILDING_MATERIALS);
        $this->items->section(SI_BUS);
        $this->items->section(SI_CAMERAS);
        $this->items->section(SI_CAR_NUMBERS)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_CLOTHES);
        $this->items->section(SI_COMPUTERS);
        $this->items->section(SI_COSMETICS)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_ELECTRICITY_GENERATOR);
        $this->items->section(SI_ELECTRONICS);
        $this->items->section(SI_EQUIPMENTS);
        $this->items->section(SI_EVENTS);
        $this->items->section(SI_FISHING);
        $this->items->section(SI_FOOD_NUTRITION)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_FRAGRANCES)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_FURNITURE);
        $this->items->section(SI_GAMES);
        $this->items->section(SI_HAJJ_AND_OMRA)->deny()->movedTo(SS_GENERAL_SERVICES);
        $this->items->section(SI_HEALTH_CARE);
        $this->items->section(SI_HEAVY_DUTY_VEHICLE);
        $this->items->section(SI_HOME_APPLIANCES)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_HUNTING)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_INDUSTRIAL_EQUIPMENT);
        $this->items->section(SI_ITEMS);
        $this->items->section(SI_LICENSES)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_MEDICAL_EQUIPMENT);
        $this->items->section(SI_MOTORCYLES);
        $this->items->section(SI_MOTORHOME);
        $this->items->section(SI_MUSICAL_INSTRUMENTS);
        $this->items->section(SI_NAUTICAL_EQUIPMENT);
        $this->items->section(SI_NUMBERS)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_PICK_UPS);
        $this->items->section(SI_PUBLIC_PLATE);
        $this->items->section(SI_SECURITY_SYSTEMS);
        $this->items->section(SI_SMARTPHONE)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_SOFTWARE_SOLUTIONS)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_SPARE_PARTS)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_SPORTS_EQUIPMENT);
        $this->items->section(SI_UNCLASSIFIED);
        $this->items->section(SI_WATCHES)->deny()->purposes([P_RENTAL, P_ASK_RENT]);
        $this->items->section(SI_WHOLESALE_DEALS)->publishLevel(MCPublishLevel::Internationl, [P_FOR_SALE]);
        $this->items->section(SI_WHOLESALE_DEALS)->deny()->purposes([ P_RENTAL, P_ASK_RENT, P_ASK_BUY, P_TRADE_IN]);
        
        $this->items->appendToTail(SI_UNCLASSIFIED);
    }
}


abstract class MCPublishLevel {
    const City          = 1;
    const Country       = 2;
    const Internationl  = 3;
}


abstract class MCRegionType {
    const Local         = 0;
    const International = 1;
}


class MCFilter implements \JsonSerializable {
    private $constraints = [];
    
    private function __construct() {
    }
    
    public function jsonSerialize() {
        return get_object_vars($this);
    }
    
    public static function newInstance() : MCFilter {
        $instance = new MCFilter();
        return $instance;
    }

    
    public function setSource(int $regionType) : MCFilter {
        $this->constraints[SOURCE] = $regionType;
        return $this;
    }
    
    
    public function setDestination(int $regionType) : MCFilter {
        $this->constraints[DESTINATION] = $regionType;
        return $this;
    }
    
    
    private function addValue(string $tag, int $value) {
        if (!isset($this->constraints[$tag])) {
            $this->constraints[$tag] = [];
        }
        if (!in_array($value, $this->constraints[$tag])) {
            $this->constraints[$tag][] = $value;
        }
    }
    
    
    public function purpose(int $purposeId) : MCFilter {
        $this->addValue(PRPS, $purposeId);
        return $this;
    }
    
    
    public function purposes(array $purposes) : MCFilter {
        foreach ($purposes as $value) {
            $this->purpose($value);
        }
        return $this;
    }
    

    public function country(int $countryId) : MCFilter {
        $this->addValue(CN, $countryId);
        return $this;
    }
    
    
    public function countries(array $countries) : MCFilter {
        foreach ($countries as $value) {
            $this->country($value);
        }
        return $this;
    }

    
    public function addCity(int $cityId) : MCFilter {
        $this->addValue(CT, $cityId);
        return $this;
    }
    
    
    public function addCities(array $cities) : MCFilter {
        foreach ($cities as $value) {
            $this->addCity($value);
        }
        return $this;
    }
       
    
    public function movedTo(int $value) {
        $this->constraints[MOVED] = $value;
        return $this;
    }
    
   
    public function dump() {
        echo json_encode($this), "\n";
    }
 }

 
 
class MCPreference implements \JsonSerializable {
    private $id;
    private $level = []; // MCPublishLevel
    private $allow = [];
    private $deny = [];
    private $sections = [];
    private $tail = [];
    
    public function jsonSerialize() {
        return get_object_vars($this);
    }
    
    
    public static function newInstance(int $id) : MCPreference {
        $instance = new MCPreference();       
        $instance->id = $id;
        $instance->publishLevel(MCPublishLevel::City);
        return $instance;
    }
    
    
    private function addSection(int $sectionId) : MCPreference {
        $section = MCPreference::newInstance($sectionId);
        unset($section->sections);
        unset($section->tail);
        $this->sections[$sectionId]=$section;
        $section->level = $this->level;
        return $section;
    }
    
    
    public function section(int $sectionId) : MCPreference {
        if (!isset($this->sections[$sectionId])) {
            return $this->addSection($sectionId);
        }
        return $this->sections[$sectionId];
    }
    
    
    public function publishLevel(int $publishLevel, array $purposes=[]) : MCPreference {
        if (!isset($this->level[$publishLevel])) {
            $this->level[$publishLevel]=[];
        }
        
        foreach ($this->level as $key => $pp) {
            if (!empty($purposes)) {
                $this->level[$key] = array_values(array_diff($pp, $purposes));
            }
        }
        
        foreach ($purposes as $value) {
            if (!in_array($value, $this->level[$publishLevel])) {
                $this->level[$publishLevel][]=$value;
            }
        }
        return $this;
    }
    
    
    public function appendToTail(int $sectionId) : MCPreference {
        $this->tail[] = $sectionId;
        return $this;
    }
    
    
    public function allow() : MCFilter {
        $filter = MCFilter::newInstance();        
        $this->allow[] = $filter;
        return $filter;
    }


    public function deny() : MCFilter {
        $filter = MCFilter::newInstance();
        $this->deny[] = $filter;
        return $filter;
    }

}


if (php_sapi_name()=='cli') {
    $preferences = new MCPostPreferences();
    $preferences->setup();
    echo json_encode($preferences, JSON_PRETTY_PRINT), "\n\n";
}